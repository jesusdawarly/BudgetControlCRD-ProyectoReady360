<!DOCTYPE html> 
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control Presupuestario - Cruz Roja Dominicana</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #0d1117 100%);
            min-height: 100vh;
            padding: 20px;
            color: #e6edf3;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(13, 17, 23, 0.95);
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.4);
            overflow: hidden;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(220, 38, 38, 0.2);
        }
        
        .header {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50 10 L60 40 L90 40 L68 58 L78 88 L50 70 L22 88 L32 58 L10 40 L40 40 Z" fill="rgba(255,255,255,0.05)"/></svg>') center/200px;
        }
        
        .header h1 {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }
        
        .switches {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 15px;
            z-index: 2;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255,255,255,0.2);
            transition: .4s;
            border-radius: 30px;
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        input:checked + .slider {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        input:checked + .slider:before {
            transform: translateX(30px);
        }
        
        .switch-label {
            color: white;
            font-size: 12px;
            margin-bottom: 5px;
            text-align: center;
            font-weight: 600;
        }
        
        .controls {
            padding: 30px;
            background: rgba(13, 17, 23, 0.8);
            border-bottom: 2px solid rgba(220, 38, 38, 0.3);
        }
        
        .add-expense {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: end;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .form-group label {
            font-weight: 600;
            color: #e6edf3;
            font-size: 0.9em;
        }
        
        .form-group select,
        .form-group input {
            padding: 12px;
            border: 2px solid rgba(220, 38, 38, 0.3);
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: rgba(13, 17, 23, 0.9);
            color: #e6edf3;
        }
        
        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #dc2626;
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.2);
        }
        
        .btn {
            padding: 12px 25px;
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(220, 38, 38, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(220, 38, 38, 0.4);
        }
        
        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .summary-card {
            background: rgba(13, 17, 23, 0.8);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
            border: 1px solid rgba(220, 38, 38, 0.1);
        }
        
        .summary-card:hover {
            transform: translateY(-2px);
        }
        
        .summary-card.total {
            border-left-color: #3b82f6;
        }
        
        .summary-card.used {
            border-left-color: #ef4444;
        }
        
        .summary-card.remaining {
            border-left-color: #10b981;
        }
        
        .summary-card h3 {
            font-size: 0.9em;
            color: #8b949e;
            margin-bottom: 8px;
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .summary-card .amount {
            font-size: 2em;
            font-weight: 700;
            color: #e6edf3;
        }
        
        .table-container {
            overflow-x: auto;
            background: rgba(13, 17, 23, 0.8);
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            border: 1px solid rgba(220, 38, 38, 0.1);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        
        th {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            color: white;
            padding: 15px 10px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        td {
            padding: 12px 10px;
            border-bottom: 1px solid rgba(220, 38, 38, 0.1);
            vertical-align: top;
            color: #e6edf3;
        }
        
        tr:hover {
            background-color: rgba(220, 38, 38, 0.05);
        }
        
        .code {
            font-family: 'Courier New', monospace;
            background: rgba(220, 38, 38, 0.1);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            color: #dc2626;
        }
        
        .amount {
            text-align: right;
            font-weight: 600;
        }
        
        .amount.positive {
            color: #10b981;
        }
        
        .amount.negative {
            color: #ef4444;
        }
        
        .category {
            font-weight: 600;
            color: #e6edf3;
        }
        
        .progress-bar {
            height: 8px;
            background: rgba(220, 38, 38, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981 0%, #059669 100%);
            transition: width 0.3s ease;
        }
        
        .progress-fill.over {
            background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%);
        }
        
        .expense-log {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid rgba(220, 38, 38, 0.2);
            border-radius: 8px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
        }
        
        .expense-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(220, 38, 38, 0.1);
            font-size: 13px;
        }
        
        .expense-item:last-child {
            border-bottom: none;
        }
        
        .expense-date {
            color: #8b949e;
            font-size: 11px;
        }
        
        .expense-amount {
            font-weight: 600;
            color: #ef4444;
        }
        
        @media (max-width: 768px) {
            .add-expense {
                flex-direction: column;
            }
            
            .form-group {
                width: 100%;
            }
            
            .switches {
                position: relative;
                top: 0;
                right: 0;
                justify-content: center;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="switches">
                <div>
                    <div class="switch-label" data-lang-key="currencySwitch">MONEDA</div>
                    <label class="switch">
                        <input type="checkbox" id="currencySwitch">
                        <span class="slider"></span>
                    </label>
                </div>
                <div>
                    <div class="switch-label" data-lang-key="languageSwitch">IDIOMA</div>
                    <label class="switch">
                        <input type="checkbox" id="languageSwitch">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            <h1 data-lang-key="title">Sistema de Control Presupuestario</h1>
            <p data-lang-key="subtitle">Cruz Roja Dominicana - Proyecto Ready 360</p>
            <p data-lang-key="credits">Software presupuestario hecho por Jesus Dawarly Ramirez (Administrador)</p>
        </div>
        
        <div class="controls">
            <div class="add-expense">
                <div class="form-group">
                    <label for="expenseCategory" data-lang-key="budgetItem">Partida Presupuestaria</label>
                    <select id="expenseCategory"></select>
                </div>
                <div class="form-group">
                    <label for="expenseAmount" data-lang-key="amount">Monto (<span id="currencySymbol">€</span>)</label>
                    <input type="number" id="expenseAmount" data-lang-placeholder="0.00" step="0.01">
                </div>
                <div class="form-group">
                    <label for="expenseDescription" data-lang-key="description">Descripción del Gasto</label>
                    <input type="text" id="expenseDescription" data-lang-key="descriptionPlaceholder">
                </div>
                <button class="btn" onclick="addExpense()" data-lang-key="addExpenseBtn">Registrar Gasto</button>
            </div>
            
            <div class="summary">
                <div class="summary-card total">
                    <h3 data-lang-key="totalBudget">Presupuesto Total</h3>
                    <div class="amount" id="totalBudget">€217,831</div>
                </div>
                <div class="summary-card used">
                    <h3 data-lang-key="totalUsed">Total Ejecutado</h3>
                    <div class="amount" id="totalUsed">€0</div>
                </div>
                <div class="summary-card remaining">
                    <h3 data-lang-key="totalRemaining">Saldo Disponible</h3>
                    <div class="amount" id="totalRemaining">€217,831</div>
                </div>
            </div>
        </div>
        
        <div class="table-container">
            <table id="budgetTable">
                <thead>
                    <tr>
                        <th data-lang-key="codeHeader">Código</th>
                        <th data-lang-key="itemHeader">Partida / Descripción</th>
                        <th data-lang-key="categoryHeader">Categoría</th>
                        <th data-lang-key="originalBudgetHeader">Presupuesto Original (<span class="currency-header">€</span>)</th>
                        <th data-lang-key="spentHeader">Gastado (<span class="currency-header">€</span>)</th>
                        <th data-lang-key="balanceHeader">Saldo (<span class="currency-header">€</span>)</th>
                        <th data-lang-key="executionHeader">% Ejecución</th>
                        <th data-lang-key="historyHeader">Historial de Gastos</th>
                    </tr>
                </thead>
                <tbody id="budgetTableBody">
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Configuración de idiomas
        const translations = {
            es: {
                title: "Sistema de Control Presupuestario",
                subtitle: "Cruz Roja Dominicana - Proyecto Ready 360",
                credits: "Software presupuestario hecho por Jesus Dawarly Ramirez (Administrador)",
                currencySwitch: "MONEDA",
                languageSwitch: "IDIOMA",
                budgetItem: "Partida Presupuestaria",
                amount: "Monto",
                description: "Descripción del Gasto",
                descriptionPlaceholder: "Detalle del gasto",
                addExpenseBtn: "Registrar Gasto",
                totalBudget: "Presupuesto Total",
                totalUsed: "Total Ejecutado",
                totalRemaining: "Saldo Disponible",
                codeHeader: "Código",
                itemHeader: "Partida / Descripción",
                categoryHeader: "Categoría",
                originalBudgetHeader: "Presupuesto Original",
                spentHeader: "Gastado",
                balanceHeader: "Saldo",
                executionHeader: "% Ejecución",
                historyHeader: "Historial de Gastos",
                selectItem: "Seleccione una partida...",
                noExpenses: "No hay gastos registrados",
                completeFields: "Por favor complete todos los campos correctamente.",
                itemNotFound: "Partida no encontrada.",
                categories: {
                    "Recursos Humanos": "Recursos Humanos",
                    "Otros Costos": "Otros Costos",
                    "Formación": "Formación",
                    "Comunicación": "Comunicación",
                    "Marco de Asociación": "Marco de Asociación",
                    "Kits Educativos": "Kits Educativos",
                    "Formación Docentes": "Formación Docentes",
                    "Capitalización": "Capitalización",
                    "Costos Indirectos": "Costos Indirectos"
                }
            },
            fr: {
                title: "Système de Contrôle Budgétaire",
                subtitle: "Croix Rouge Dominicaine - Projet Ready 360",
                credits: "Logiciel budgétaire créé par Jesus Dawarly Ramirez (Administrateur)",
                currencySwitch: "DEVISE",
                languageSwitch: "LANGUE",
                budgetItem: "Poste Budgétaire",
                amount: "Montant",
                description: "Description de la Dépense",
                descriptionPlaceholder: "Détail de la dépense",
                addExpenseBtn: "Enregistrer Dépense",
                totalBudget: "Budget Total",
                totalUsed: "Total Exécuté",
                totalRemaining: "Solde Disponible",
                codeHeader: "Code",
                itemHeader: "Poste / Description",
                categoryHeader: "Catégorie",
                originalBudgetHeader: "Budget Original",
                spentHeader: "Dépensé",
                balanceHeader: "Solde",
                executionHeader: "% Exécution",
                historyHeader: "Historique des Dépenses",
                selectItem: "Sélectionnez un poste...",
                noExpenses: "Aucune dépense enregistrée",
                completeFields: "Veuillez remplir tous les champs correctement.",
                itemNotFound: "Poste non trouvé.",
                categories: {
                    "Recursos Humanos": "Ressources Humaines",
                    "Otros Costos": "Autres Coûts",
                    "Formación": "Formation",
                    "Comunicación": "Communication",
                    "Marco de Asociación": "Cadre d'Association",
                    "Kits Educativos": "Kits Éducatifs",
                    "Formación Docentes": "Formation Enseignants",
                    "Capitalización": "Capitalisation",
                    "Costos Indirectos": "Coûts Indirects"
                }
            }
        };

        // Variables globales
        let currentLanguage = 'es';
        let currentCurrency = 'EUR';
        const EUR_TO_DOP_RATE = 66.15; // Tasa de cambio actual

        const budgetData = [
            // RECURSOS HUMANOS
            {
                code: "HR.SUP",
                description: "Supervisor Logístico/Administrativo",
                category: "Recursos Humanos",
                originalBudget: 20000,
                used: 0,
                expenses: []
            },
            {
                code: "HR.PM",
                description: "Coordinador del Proyecto (24 meses)",
                category: "Recursos Humanos",
                originalBudget: 24000,
                used: 0,
                expenses: []
            },
            
            // OTROS COSTOS
            {
                code: "FUNC",
                description: "Costos de Funcionamiento (18 meses)",
                category: "Otros Costos",
                originalBudget: 7200,
                used: 0,
                expenses: []
            },
            {
                code: "EQUIP",
                description: "Compra de Equipos",
                category: "Otros Costos",
                originalBudget: 1660,
                used: 0,
                expenses: []
            },
            
            // FORMACIÓN FRC/AFD
            {
                code: "SNFORM.PD",
                description: "Per Diem - Formación FRC/AFD",
                category: "Formación",
                originalBudget: 152,
                used: 0,
                expenses: []
            },
            {
                code: "SNFORM.TX",
                description: "Taxi - Requerimientos de Viaje Formación",
                category: "Formación",
                originalBudget: 100,
                used: 0,
                expenses: []
            },
            
            // COMUNICACIÓN
            {
                code: "R0A0.COM",
                description: "Cargo por sobrequipaje/Transporte de herramientas",
                category: "Comunicación",
                originalBudget: 200,
                used: 0,
                expenses: []
            },
            {
                code: "R0.MOV",
                description: "Gastos de Movilización (Taxi)",
                category: "Comunicación",
                originalBudget: 2000,
                used: 0,
                expenses: []
            },
            
            // R3.A11 - MARCO DE ASOCIACIÓN
            {
                code: "R3A11.1",
                description: "Línea Base/Final - Indicadores",
                category: "Marco de Asociación",
                originalBudget: 30000,
                used: 0,
                expenses: []
            },
            {
                code: "R3A11.2.VIS",
                description: "Visibilidad para el Proyecto",
                category: "Marco de Asociación",
                originalBudget: 2000,
                used: 0,
                expenses: []
            },
            {
                code: "R3A11.2.PROD",
                description: "Producción de Elementos de Visibilidad",
                category: "Marco de Asociación",
                originalBudget: 4000,
                used: 0,
                expenses: []
            },
            {
                code: "R3A11.3.COF",
                description: "COPIL y COTECH - Coffee",
                category: "Marco de Asociación",
                originalBudget: 500,
                used: 0,
                expenses: []
            },
            {
                code: "R3A11.3.PRT",
                description: "COPIL y COTECH - Print",
                category: "Marco de Asociación",
                originalBudget: 60,
                used: 0,
                expenses: []
            },
            {
                code: "R3A11.3.GOD",
                description: "COPIL y COTECH - Goodies",
                category: "Marco de Asociación",
                originalBudget: 374,
                used: 0,
                expenses: []
            },
            {
                code: "R3A11.4",
                description: "Reunión de Lanzamiento de Comités - Coffee",
                category: "Marco de Asociación",
                originalBudget: 75,
                used: 0,
                expenses: []
            },
            
            // R3.A12 - KITS EDUCATIVOS
            {
                code: "R3A12.1.ID",
                description: "Creación Identidad Visual del Proyecto",
                category: "Kits Educativos",
                originalBudget: 8000,
                used: 0,
                expenses: []
            },
            {
                code: "R3A12.1.TEST",
                description: "Test de Visibilidad del Proyecto",
                category: "Kits Educativos",
                originalBudget: 12000,
                used: 0,
                expenses: []
            },
            {
                code: "R3A12.2.MAT",
                description: "Preparación Material Didáctico + Currículas",
                category: "Kits Educativos",
                originalBudget: 49000,
                used: 0,
                expenses: []
            },
            {
                code: "R3A12.2.MOV",
                description: "Movilización Comités Técnico + Pedagógico",
                category: "Kits Educativos",
                originalBudget: 240,
                used: 0,
                expenses: []
            },
            {
                code: "R3A12.3.IMP",
                description: "Impresión Prototipo de Herramientas",
                category: "Kits Educativos",
                originalBudget: 1500,
                used: 0,
                expenses: []
            },
            {
                code: "R3A12.3.SNK",
                description: "Snack para Niños (Test)",
                category: "Kits Educativos",
                originalBudget: 60,
                used: 0,
                expenses: []
            },
            {
                code: "R3A12.3.PDV",
                description: "Per Diem Voluntarios - Test",
                category: "Kits Educativos",
                originalBudget: 600,
                used: 0,
                expenses: []
            },
            {
                code: "R3A12.3.PDC",
                description: "Per Diem Chef de Proyecto - Test",
                category: "Kits Educativos",
                originalBudget: 80,
                used: 0,
                expenses: []
            },
            {
                code: "R3A12.4.FOD",
                description: "Comida - Formación Voluntarios",
                category: "Kits Educativos",
                originalBudget: 425,
                used: 0,
                expenses: []
            },
            {
                code: "R3A12.4.PD",
                description: "Per Diem - Formación Voluntarios",
                category: "Kits Educativos",
                originalBudget: 150,
                used: 0,
                expenses: []
            },
            {
                code: "R3A12.4.MAT",
                description: "Material: Cuaderno/Bolígrafo",
                category: "Kits Educativos",
                originalBudget: 225,
                used: 0,
                expenses: []
            },
            {
                code: "R3A12.4.VIS",
                description: "Visibilidad para Voluntarios",
                category: "Kits Educativos",
                originalBudget: 330,
                used: 0,
                expenses: []
            },
            {
                code: "R3A12.5",
                description: "Presentación a Comités - Coffee",
                category: "Kits Educativos",
                originalBudget: 30,
                used: 0,
                expenses: []
            },
            {
                code: "R3A12.6",
                description: "Impresión y Producción Final",
                category: "Kits Educativos",
                originalBudget: 19000,
                used: 0,
                expenses: []
            },
            
            // R3.A13 - FORMACIÓN DOCENTES
            {
                code: "R3A13.1",
                description: "Presentación a Directores - Coffee",
                category: "Formación Docentes",
                originalBudget: 300,
                used: 0,
                expenses: []
            },
            {
                code: "R3A13.2",
                description: "Construcción Contenido - Consultoría",
                category: "Formación Docentes",
                originalBudget: 8000,
                used: 0,
                expenses: []
            },
            {
                code: "R3A13.3.SAL",
                description: "Alquiler Salas con Coffee - Santo Domingo",
                category: "Formación Docentes",
                originalBudget: 1500,
                used: 0,
                expenses: []
            },
            {
                code: "R3A13.3.FOD",
                description: "Comida - Formación Santo Domingo",
                category: "Formación Docentes",
                originalBudget: 840,
                used: 0,
                expenses: []
            },
            {
                code: "R3A13.3.IMP",
                description: "Impresión Documentos - Formación",
                category: "Formación Docentes",
                originalBudget: 10,
                used: 0,
                expenses: []
            },
            {
                code: "R3A13.3.GOD",
                description: "Goodies - Formación",
                category: "Formación Docentes",
                originalBudget: 500,
                used: 0,
                expenses: []
